myPackages <- c("lme4", "rsq", "MuMIn", "optimx", "MASS", "dplyr", "ggplot2",
"HLMdiag", "lmtest", "lmerTest", "psy", "PowerUpR","nlme", "MVN",
"skimr", "tidyverse", "pacman", "lavaan", "semTools", "gsl")
# then check if all the needed packages are installed by checking against the list
# of already installed packages in R:
installed <- sapply(myPackages, function(p) p %in% rownames(installed.packages()))
# and install any missing packages
if (any(!installed)) {
install.packages(myPackages[!installed])
}
# then initiate the packages management library:
library(pacman)
# to load the rest of the needed libraries in this lab at once:
p_load(lme4, rsq, MuMIn, optimx, MASS, dplyr, ggplot2, HLMdiag, lmtest, lmerTest,
psy, PowerUpR, nlme, MVN, skimr, tidyverse, lavaan, semTools, gsl)
#====================Data loading===========================================#
PISA09.PathAnalysis <-
read.csv("https://raw.githubusercontent.com/alibahkali/EDPSY960/main/PISA09.PathAnalysis.csv")
#====================Clean missing records==================================#
# Loop through each column in the data frame to convert missing values into NAs
for(col in names(PISA09.PathAnalysis)) {
PISA09.PathAnalysis[[col]][PISA09.PathAnalysis[[col]] == 9999] <- NA
}
# Remove records with any missing values from the data frame
PISA09.PathAnalysis <- na.omit(PISA09.PathAnalysis)
#===========================================================================#
# Assuming data_clean is the dataset after listwise deletion
mvn(PISA09.PathAnalysis[-c(6,7)], subset = NULL, mvnTest = c("mardia"),
covariance = TRUE, tol = 1e-25, alpha = 0.5,
scale = FALSE, desc = TRUE, transform = "none", R = 1000,
univariateTest = c("Lillie"),
univariatePlot = "qqplot", multivariatePlot = "qq",
multivariateOutlierMethod = "quan", bc = FALSE, bcType = "rounded",
showOutliers = FALSE, showNewData = FALSE)
#===========================================================================#
# Setup path model
PISA.09.Model <- '
# Regressions
READING ~ A*MEMO + B*ELAB + C*CSTRAT
MEMO ~ D*ESCS + E*GENDER
ELAB ~ F*ESCS + G*GENDER + H*IMMIGR
CSTRAT ~ I*ESCS + J*GENDER + K*IMMIGR
# Mediation Analysis
# Indirect effect of ESCS on READING through MEMO
DA := D*A
# Indirect effect of ESCS on READING through ELAB
FB := F*B
# Indirect effect of ESCS on READING through CSTRAT
IC := I*C
# Total indirect effect of ESCS on READING
DA_FB_IC := DA + FB + IC
# Indirect effect of GENDER on READING through MEMO
EA := E*A
# Indirect effect of GENDER on READING through ELAB
GB := G*B
# Indirect effect of GENDER on READING through CSTRAT
JC := J*C
# Total indirect effect of GENDER on READING
EA_GB_JC := EA + GB + JC
# Indirect effect of IMMIGR on READING through ELAB
HB := H*B
# Indirect effect of IMMIGR on READING through CSTRAT
KC := K*C
# Total indirect effect of IMMIGR on READING
HB_KC := HB + KC
'
# Generate summary of path analysis
PISA.09.Model.fit <- sem(PISA.09.Model, data = PISA09.PathAnalysis, estimator = "ml")
summary(PISA.09.Model.fit, fit.measures = TRUE, rsq = T)
modindices(PISA.09.Model.fit, standardized=TRUE, power=TRUE, delta=0.1, alpha=.05,
high.power=.80) %>%
arrange(desc(mi))
PISA09.PathAnalysis$READINGs <- scale(PISA09.PathAnalysis$READING,
center = TRUE, scale = TRUE)
# Setup path model
PISA.09.Model <- '
# Regressions
READINGs ~ A*MEMO + B*ELAB + C*CSTRAT
MEMO ~ D*ESCS + E*GENDER
ELAB ~ F*ESCS + G*GENDER + H*IMMIGR
CSTRAT ~ I*ESCS + J*GENDER + K*IMMIGR
# Mediation Analysis
# Indirect effect of ESCS on READING through MEMO
DA := D*A
# Indirect effect of ESCS on READING through ELAB
FB := F*B
# Indirect effect of ESCS on READING through CSTRAT
IC := I*C
# Total indirect effect of ESCS on READING
DA_FB_IC := DA + FB + IC
# Indirect effect of GENDER on READING through MEMO
EA := E*A
# Indirect effect of GENDER on READING through ELAB
GB := G*B
# Indirect effect of GENDER on READING through CSTRAT
JC := J*C
# Total indirect effect of GENDER on READING
EA_GB_JC := EA + GB + JC
# Indirect effect of IMMIGR on READING through ELAB
HB := H*B
# Indirect effect of IMMIGR on READING through CSTRAT
KC := K*C
# Total indirect effect of IMMIGR on READING
HB_KC := HB + KC
'
# Generate summary of path analysis
PISA.09.Model.fit <- sem(PISA.09.Model, data = PISA09.PathAnalysis, estimator = "ml")
summary(PISA.09.Model.fit, fit.measures = TRUE, rsq = T)
modindices(PISA.09.Model.fit, standardized=TRUE, power=TRUE, delta=0.1, alpha=.05,
high.power=.80) %>%
arrange(desc(mi))
gc()
myPackages <- c("lme4", "rsq", "MuMIn", "optimx", "MASS", "dplyr", "ggplot2",
"HLMdiag", "lmtest", "lmerTest", "psy", "PowerUpR","nlme", "MVN",
"skimr", "tidyverse", "pacman", "lavaan", "semTools", "gsl")
# then check if all the needed packages are installed by checking against the list
# of already installed packages in R:
installed <- sapply(myPackages, function(p) p %in% rownames(installed.packages()))
# and install any missing packages
if (any(!installed)) {
install.packages(myPackages[!installed])
}
# then initiate the packages management library:
library(pacman)
# to load the rest of the needed libraries in this lab at once:
p_load(lme4, rsq, MuMIn, optimx, MASS, dplyr, ggplot2, HLMdiag, lmtest, lmerTest,
psy, PowerUpR, nlme, MVN, skimr, tidyverse, lavaan, semTools, gsl)
PISA09.PathAnalysis <-
read.csv("https://raw.githubusercontent.com/alibahkali/EDPSY960/main/PISA09.PathAnalysis.csv")
#====================Clean missing records==================================#
# Loop through each column in the data frame to convert missing values into NAs
for(col in names(PISA09.PathAnalysis)) {
PISA09.PathAnalysis[[col]][PISA09.PathAnalysis[[col]] == 9999] <- NA
}
# Remove records with any missing values from the data frame
PISA09.PathAnalysis <- na.omit(PISA09.PathAnalysis)
#===========================================================================#
# Setup path model
PISA.09.Model <- '
# Regressions
READINGs ~ A*MEMO + B*ELAB + C*CSTRAT
MEMO ~ D*ESCS + E*GENDER
ELAB ~ F*ESCS + G*GENDER + H*IMMIGR
CSTRAT ~ I*ESCS + J*GENDER + K*IMMIGR
# Mediation Analysis
# Indirect effect of ESCS on READING through MEMO
DA := D*A
# Indirect effect of ESCS on READING through ELAB
FB := F*B
# Indirect effect of ESCS on READING through CSTRAT
IC := I*C
# Total indirect effect of ESCS on READING
DA_FB_IC := DA + FB + IC
# Indirect effect of GENDER on READING through MEMO
EA := E*A
# Indirect effect of GENDER on READING through ELAB
GB := G*B
# Indirect effect of GENDER on READING through CSTRAT
JC := J*C
# Total indirect effect of GENDER on READING
EA_GB_JC := EA + GB + JC
# Indirect effect of IMMIGR on READING through ELAB
HB := H*B
# Indirect effect of IMMIGR on READING through CSTRAT
KC := K*C
# Total indirect effect of IMMIGR on READING
HB_KC := HB + KC
'
# Generate summary of path analysis
PISA.09.Model.fit <- sem(PISA.09.Model, data = PISA09.PathAnalysis, estimator = "ml")
#====================Clean missing records==================================#
# Loop through each column in the data frame to convert missing values into NAs
for(col in names(PISA09.PathAnalysis)) {
PISA09.PathAnalysis[[col]][PISA09.PathAnalysis[[col]] == 9999] <- NA
}
# Remove records with any missing values from the data frame
PISA09.PathAnalysis <- na.omit(PISA09.PathAnalysis)
#===========================================================================#
# Setup path model
PISA.09.Model <- '
# Regressions
READINGs ~ A*MEMO + B*ELAB + C*CSTRAT
MEMO ~ D*ESCS + E*GENDER
ELAB ~ F*ESCS + G*GENDER + H*IMMIGR
CSTRAT ~ I*ESCS + J*GENDER + K*IMMIGR
# Mediation Analysis
# Indirect effect of ESCS on READING through MEMO
DA := D*A
# Indirect effect of ESCS on READING through ELAB
FB := F*B
# Indirect effect of ESCS on READING through CSTRAT
IC := I*C
# Total indirect effect of ESCS on READING
DA_FB_IC := DA + FB + IC
# Indirect effect of GENDER on READING through MEMO
EA := E*A
# Indirect effect of GENDER on READING through ELAB
GB := G*B
# Indirect effect of GENDER on READING through CSTRAT
JC := J*C
# Total indirect effect of GENDER on READING
EA_GB_JC := EA + GB + JC
# Indirect effect of IMMIGR on READING through ELAB
HB := H*B
# Indirect effect of IMMIGR on READING through CSTRAT
KC := K*C
# Total indirect effect of IMMIGR on READING
HB_KC := HB + KC
'
# Generate summary of path analysis
PISA.09.Model.fit <- sem(PISA.09.Model, data = PISA09.PathAnalysis, estimator = "ml")
#===========================================================================#
# Setup path model
PISA.09.Model <- '
# Regressions
READING ~ A*MEMO + B*ELAB + C*CSTRAT
MEMO ~ D*ESCS + E*GENDER
ELAB ~ F*ESCS + G*GENDER + H*IMMIGR
CSTRAT ~ I*ESCS + J*GENDER + K*IMMIGR
# Mediation Analysis
# Indirect effect of ESCS on READING through MEMO
DA := D*A
# Indirect effect of ESCS on READING through ELAB
FB := F*B
# Indirect effect of ESCS on READING through CSTRAT
IC := I*C
# Total indirect effect of ESCS on READING
DA_FB_IC := DA + FB + IC
# Indirect effect of GENDER on READING through MEMO
EA := E*A
# Indirect effect of GENDER on READING through ELAB
GB := G*B
# Indirect effect of GENDER on READING through CSTRAT
JC := J*C
# Total indirect effect of GENDER on READING
EA_GB_JC := EA + GB + JC
# Indirect effect of IMMIGR on READING through ELAB
HB := H*B
# Indirect effect of IMMIGR on READING through CSTRAT
KC := K*C
# Total indirect effect of IMMIGR on READING
HB_KC := HB + KC
'
# Generate summary of path analysis
PISA.09.Model.fit <- sem(PISA.09.Model, data = PISA09.PathAnalysis, estimator = "ml")
summary(PISA.09.Model.fit, fit.measures = TRUE, rsq = T)
#==============================================================================#
modindices(PISA.09.Model.fit, standardized=TRUE, power=TRUE, delta=0.1, alpha=.05,
high.power=.80) %>%
filter(op != "~~") %>%
arrange(desc(mi))
#===========================================================================#
# Setup path model
PISA.09.Model <- '
# Regressions
READING ~ A*MEMO + B*ELAB + C*CSTRAT
MEMO ~ D*ESCS + E*GENDER + L*CSTRAT
ELAB ~ F*ESCS + G*GENDER + H*IMMIGR
CSTRAT ~ I*ESCS + J*GENDER + K*IMMIGR
# Mediation Analysis
#===================#
# Indirect effect of ESCS on READING through MEMO
DA := D*A
# Indirect effect of ESCS on READING through ELAB
FB := F*B
# Indirect effect of ESCS on READING through CSTRAT
IC := I*C
# Indirect effect of ESCS on READING through CSTRAT & MEMOR (new1)
ILA:= I*L*A
# Total indirect effect of ESCS on READING
DA_FB_IC := DA + FB + IC + ILA
#===================#
# Indirect effect of GENDER on READING through MEMO
EA := E*A
# Indirect effect of GENDER on READING through ELAB
GB := G*B
# Indirect effect of GENDER on READING through CSTRAT
JC := J*C
# Indirect effect of GENDER on READING through CSTRAT & MEMO (new)
JLA := J*L*A
# Total indirect effect of GENDER on READING
EA_GB_JC := EA + GB + JC + JLA
#===================#
# Indirect effect of IMMIGR on READING through ELAB
HB := H*B
# Indirect effect of IMMIGR on READING through CSTRAT
KC := K*C
# Indirect effect of IMMIGR on READING through CSTRAT & MEMO (new)
KLA := K*L*A
# Total indirect effect of IMMIGR on READING
HB_KC := HB + KC + KLA
'
# Generate summary of path analysis
PISA.09.Model.fit <- sem(PISA.09.Model, data = PISA09.PathAnalysis, estimator = "ml")
summary(PISA.09.Model.fit, fit.measures = TRUE, rsq = T)
modindices(PISA.09.Model.fit, standardized=TRUE, power=TRUE, delta=0.1, alpha=.05,
high.power=.80) %>%
arrange(desc(mi))
modindices(PISA.09.Model.fit, standardized=TRUE, power=TRUE, delta=0.1, alpha=.05,
high.power=.80) %>%
filter(op != "~~") %>%
arrange(desc(mi))
